<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Threshold regression with a censored covariate — thlm • censCov</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Threshold regression with a censored covariate — thlm" />

<meta property="og:description" content="This function fits a linear regression model when there is
a censored covaraite. The method involves thresholding the continuous
covariate into a binary covariate. A collection of threshold
regression methods are implemented to obtain the estimator of the
regression coefficient as well as to test the significance of the
effect of the censored covariate. When there is no censoring,
the method reduces to the simple linear regression.
The model assumes the linear regression model:
$$Y = a_0 + a_1X + a_2Z + e,$$ where X is the covariate of interest which
is subject to right censoring, Z is a covariate matrix that are fully
observed, Y is the response variable, and e is an independent randon
error term with mean 0 and finite variance.
The hypothesis test of association is based on the significance of the
regression coefficient, a1. However, when deletion threshold
regression or complete threshold regression is executed, an equivalent
but easy-to-evaluate test is performed. Namely, given a threshold
t*, we define a derived binary covariate, X*, such that X* = 1 when X
&amp;gt; t* and X* = 0 when X is uncensored and X &amp;lt; t*. The proposed linear
regression can be expressed as $$E(Y|X^\ast, Z) = b_0 + b_1X^\ast +
b_2Z.$$ The proposed hypothesis test of association can be tested by the
significance of b1. Under the assumption that X is independent of Z
given X*, b2 is equivalent to a2." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">censCov</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/censCov-examples.html">Introduction to *censCov*</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/stc04003/censCov">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Threshold regression with a censored covariate</h1>
    <small class="dont-index">Source: <a href='https://github.com/stc04003/censCov/blob/master/R/threshold-reg.R'><code>R/threshold-reg.R</code></a></small>
    <div class="hidden name"><code>thlm.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function fits a linear regression model when there is
a censored covaraite. The method involves thresholding the continuous
covariate into a binary covariate. A collection of threshold
regression methods are implemented to obtain the estimator of the
regression coefficient as well as to test the significance of the
effect of the censored covariate. When there is no censoring,
the method reduces to the simple linear regression.</p>
<p>The model assumes the linear regression model:
$$Y = a_0 + a_1X + a_2Z + e,$$ where X is the covariate of interest which
is subject to right censoring, Z is a covariate matrix that are fully
observed, Y is the response variable, and e is an independent randon
error term with mean 0 and finite variance.</p>
<p>The hypothesis test of association is based on the significance of the
regression coefficient, a1. However, when deletion threshold
regression or complete threshold regression is executed, an equivalent
but easy-to-evaluate test is performed. Namely, given a threshold
t*, we define a derived binary covariate, X*, such that X* = 1 when X
&gt; t* and X* = 0 when X is uncensored and X &lt; t*. The proposed linear
regression can be expressed as $$E(Y|X^\ast, Z) = b_0 + b_1X^\ast +
b_2Z.$$ The proposed hypothesis test of association can be tested by the
significance of b1. Under the assumption that X is independent of Z
given X*, b2 is equivalent to a2.</p>
    
    </div>

    <pre class="usage"><span class='fu'>thlm</span>(<span class='no'>formula</span>, <span class='no'>data</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"cc"</span>, <span class='st'>"reverse"</span>, <span class='st'>"deletion-threshold"</span>,
  <span class='st'>"complete-threshold"</span>, <span class='st'>"all"</span>), <span class='kw'>B</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='no'>subset</span>, <span class='kw'>x.upplim</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>t0</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'>thlm.control</span>())</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>A formula expression in the form <code>response ~ predictors</code>.
The response variable is assumed to be fully observed.
The <code>thlm</code> function can accommodate at most one censored covariate,
which is entered as an <code>Surv</code> object; see <code><a href='https://www.rdocumentation.org/packages/survival/topics/Surv'>survival::Surv</a></code> for more detail.
When all the covariates are uncensored, the <code>thlm</code> function returns a <code>lm</code> object.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>An optional data frame list or environment contains variables in the <code>formula</code> and
the <code>subset</code> argument. If left unspecified, the variables are taken
from <code><a href='https://www.rdocumentation.org/packages/base/topics/environment'>environment(formula)</a></code>, typically the environment from which <code>thlm</code> is called.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>A character string specifying the threshold regression methods to be used.
The following are permitted:</p><dl class='dl-horizontal'>
  <dt><code>cc</code></dt><dd><p>for complete-cases regression</p></dd>
  <dt><code>reverse</code></dt><dd><p>for reverse survival regression</p></dd>
  <dt><code>deletion-threshold</code></dt><dd><p>for deletion threshold regression</p></dd>
  <dt><code>complete-threshold</code></dt><dd><p>for complete threshold regression</p></dd>
  <dt><code>all</code></dt><dd><p>for all four approaches</p></dd>
</dl></td>
    </tr>
    <tr>
      <th>B</th>
      <td><p>A numeric value specifies the bootstrap size for estimating
the standard deviation of regression coefficient for the censored
covariate when <code>method = "deletion-threshold"</code> or
<code>method = "complete-threshold"</code>.
When <code>B = 0</code>, only the beta estimate will be displayed.</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>An optional vector specifying a subset of observations to be
used in the fitting process.</p></td>
    </tr>
    <tr>
      <th>x.upplim</th>
      <td><p>An optional numeric value specifies the upper support
of the censored covariate. When left unspecified, the maximum of the
censored covariate will be used.</p></td>
    </tr>
    <tr>
      <th>t0</th>
      <td><p>An optional numeric value specifies the threshold when
<code>method = "dt"</code> or <code>"ct"</code>.
When left unspecified, an optimal threshold will be determined to optimize test power
using the proposed procedure in Qian et al (2018).</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>A list of parameters. The parameters are</p><dl class='dl-horizontal'>
  <dt><code>t0.interval</code></dt><dd><p>controls the end points of the interval to be searched for
the optimal threshold when <code>t0</code> is left unspecified</p></dd>
  <dt><code>t0.plot</code></dt><dd><p>controls whether the objective function will be plotted.
When <code>t0.plot</code> is ture, both the raw <code>t0.plot</code> values and the smoothed estimates
(using local polynomial regression fitting) are plotted.</p></dd>
</dl></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Qian, J., Chiou, S.H., Maye, J.E., Atem, F., Johnson, K.A. and Betensky, R.A. (2018)
Threshold regression to accommodate a censored covariate, <em>Biometrics</em>, <b>74</b>(4):
1261--1270.</p>
<p>Atem, F., Qian, J., Maye J.E., Johnson, K.A. and Betensky, R.A. (2017),
Linear regression with a randomly censored covariate: Application to an Alzheimer's study.
<em>Journal of the Royal Statistical Society: Series C</em>, <b>66</b>(2):313--328.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>simDat</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>n</span>) {
  <span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Exponential'>rexp</a></span>(<span class='no'>n</span>, <span class='fl'>3</span>)
  <span class='no'>Z</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Uniform'>runif</a></span>(<span class='no'>n</span>, <span class='fl'>1</span>, <span class='fl'>6</span>)
  <span class='no'>Y</span> <span class='kw'>&lt;-</span> <span class='fl'>0.5</span> + <span class='fl'>0.5</span> * <span class='no'>X</span> - <span class='fl'>0.5</span> * <span class='no'>Z</span> + <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='no'>n</span>, <span class='fl'>0</span>, <span class='fl'>.75</span>)
  <span class='no'>cstime</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Exponential'>rexp</a></span>(<span class='no'>n</span>, <span class='fl'>.75</span>)
  <span class='no'>delta</span> <span class='kw'>&lt;-</span> (<span class='no'>X</span> <span class='kw'>&lt;=</span> <span class='no'>cstime</span>) * <span class='fl'>1</span>
  <span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Extremes'>pmin</a></span>(<span class='no'>X</span>, <span class='no'>cstime</span>)
  <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/data.frame'>data.frame</a></span>(<span class='kw'>Y</span> <span class='kw'>=</span> <span class='no'>Y</span>, <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>X</span>, <span class='kw'>Z</span> <span class='kw'>=</span> <span class='no'>Z</span>, <span class='kw'>delta</span> <span class='kw'>=</span> <span class='no'>delta</span>)
}

<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>0</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'>simDat</span>(<span class='fl'>200</span>)

<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>survival</span>)
<span class='co'>## Falsely assumes all covariates are free of censoring</span>
<span class='fu'>thlm</span>(<span class='no'>Y</span> ~ <span class='no'>X</span> + <span class='no'>Z</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dat</span>)</div><div class='output co'>#&gt; 
#&gt;  Call: thlm(formula = Y ~ X + Z, data = dat)
#&gt; 
#&gt;  Hypothesis test of association
#&gt;  H0: a1 = 0, p-value = 0.0023 
#&gt; </div><div class='input'>
<span class='co'>## Complete cases regression</span>
<span class='fu'>thlm</span>(<span class='no'>Y</span> ~ <span class='fu'><a href='https://www.rdocumentation.org/packages/survival/topics/Surv'>Surv</a></span>(<span class='no'>X</span>, <span class='no'>delta</span>) + <span class='no'>Z</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dat</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"cc"</span>)</div><div class='output co'>#&gt; 
#&gt;  Call: thlm(formula = Y ~ Surv(X, delta) + Z, data = dat, method = "cc")
#&gt; 
#&gt;  Hypothesis test of association
#&gt; H0: a1 = 0, p-value = 0.0033 
#&gt; </div><div class='input'>
<span class='co'>## reverse survival regression</span>
<span class='fu'>thlm</span>(<span class='no'>Y</span> ~ <span class='fu'><a href='https://www.rdocumentation.org/packages/survival/topics/Surv'>Surv</a></span>(<span class='no'>X</span>, <span class='no'>delta</span>) + <span class='no'>Z</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dat</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"rev"</span>)</div><div class='output co'>#&gt; 
#&gt;  Call: thlm(formula = Y ~ Surv(X, delta) + Z, data = dat, method = "rev")
#&gt; 
#&gt;  Hypothesis test of association
#&gt; H0: a1 = 0, p-value = 0.0026 
#&gt; </div><div class='input'>
<span class='co'>## threshold regression without bootstrap</span>
<span class='fu'>thlm</span>(<span class='no'>Y</span> ~ <span class='fu'><a href='https://www.rdocumentation.org/packages/survival/topics/Surv'>Surv</a></span>(<span class='no'>X</span>, <span class='no'>delta</span>) + <span class='no'>Z</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dat</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"del"</span>)</div><div class='output co'>#&gt; 
#&gt;  Call: thlm(formula = Y ~ Surv(X, delta) + Z, data = dat, method = "del")
#&gt; 
#&gt;  Hypothesis test of association
#&gt;  H0: b1 = 0, p-value = 0.0080 
#&gt; </div><div class='input'><span class='fu'>thlm</span>(<span class='no'>Y</span> ~ <span class='fu'><a href='https://www.rdocumentation.org/packages/survival/topics/Surv'>Surv</a></span>(<span class='no'>X</span>, <span class='no'>delta</span>) + <span class='no'>Z</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dat</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"com"</span>, <span class='kw'>control</span> <span class='kw'>=</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>t0.interval</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0.2</span>, <span class='fl'>0.6</span>), <span class='kw'>t0.plot</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>))</div><div class='output co'>#&gt; 
#&gt;  Call: thlm(formula = Y ~ Surv(X, delta) + Z, data = dat, method = "com", 
#&gt;     control = list(t0.interval = c(0.2, 0.6), t0.plot = FALSE))
#&gt; 
#&gt;  Hypothesis test of association
#&gt;  H0: b1 = 0, p-value = 0.0040 
#&gt; </div><div class='input'>
<span class='co'>## threshold regression with bootstrap</span>
<span class='fu'>thlm</span>(<span class='no'>Y</span> ~ <span class='fu'><a href='https://www.rdocumentation.org/packages/survival/topics/Surv'>Surv</a></span>(<span class='no'>X</span>, <span class='no'>delta</span>) + <span class='no'>Z</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dat</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"del"</span>, <span class='kw'>B</span> <span class='kw'>=</span> <span class='fl'>100</span>)</div><div class='img'><img src='thlm-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; 
#&gt;  Call: thlm(formula = Y ~ Surv(X, delta) + Z, data = dat, method = "del", 
#&gt;     B = 100)
#&gt; 
#&gt;  Hypothesis test of association
#&gt;  H0: b1 = 0, p-value = 0.0080
#&gt;  H0: a1 = 0, p-value = 0.0082 
#&gt; </div><div class='input'><span class='fu'>thlm</span>(<span class='no'>Y</span> ~ <span class='fu'><a href='https://www.rdocumentation.org/packages/survival/topics/Surv'>Surv</a></span>(<span class='no'>X</span>, <span class='no'>delta</span>) + <span class='no'>Z</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dat</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"com"</span>, <span class='kw'>B</span> <span class='kw'>=</span> <span class='fl'>100</span>)</div><div class='img'><img src='thlm-2.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; 
#&gt;  Call: thlm(formula = Y ~ Surv(X, delta) + Z, data = dat, method = "com", 
#&gt;     B = 100)
#&gt; 
#&gt;  Hypothesis test of association
#&gt;  H0: b1 = 0, p-value = 0.0053
#&gt;  H0: a1 = 0, p-value = 0.0111 
#&gt; </div><div class='input'>
<span class='co'>## display all</span>
<span class='fu'>thlm</span>(<span class='no'>Y</span> ~ <span class='fu'><a href='https://www.rdocumentation.org/packages/survival/topics/Surv'>Surv</a></span>(<span class='no'>X</span>, <span class='no'>delta</span>) + <span class='no'>Z</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dat</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"all"</span>, <span class='kw'>B</span> <span class='kw'>=</span> <span class='fl'>100</span>)</div><div class='img'><img src='thlm-3.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; 
#&gt;  Call: thlm(formula = Y ~ Surv(X, delta) + Z, data = dat, method = "all", 
#&gt;     B = 100)
#&gt; 
#&gt;  Hypothesis test of association
#&gt; 
#&gt;  Complete-cases
#&gt;  H0: a1 = 0, p-value = 0.0033 
#&gt; 
#&gt;  Reverse survival
#&gt;  H0: a1 = 0, p-value = 0.0026 
#&gt; 
#&gt;  Deletion threshold
#&gt;  H0: b1 = 0: p-value = 0.0080
#&gt;  H0: a1 = 0: p-value = 0.0090
#&gt; 
#&gt;  Complete threshold
#&gt;  H0: b1 = 0: p-value = 0.0053
#&gt;  H0: a1 = 0: p-value = 0.0136</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Jing Qian.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

