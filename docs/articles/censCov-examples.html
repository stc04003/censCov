<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to <em>censCov</em> • censCov</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to &lt;em&gt;censCov&lt;/em&gt;">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">censCov</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/censCov-examples.html">Introduction to *censCov*</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/stc04003/censCov">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to <em>censCov</em>
</h1>
                        <h4 class="author">Sy Han (Steven) Chiou</h4>
            
            <h4 class="date">2019-05-21</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/stc04003/censCov/blob/master/vignettes/censCov-examples.Rmd"><code>vignettes/censCov-examples.Rmd</code></a></small>
      <div class="hidden name"><code>censCov-examples.Rmd</code></div>

    </div>

    
    
<p>In this vignette, we demonstrate how to use the <code>thlm</code> function in <strong><code>censCov</code></strong> package to fit linear regression model with censored covariate using the methods proposed in <span class="citation">Qian et al. (2018)</span>.</p>
<div id="notations" class="section level2">
<h2 class="hasAnchor">
<a href="#notations" class="anchor"></a>Notations</h2>
<p>Suppose the linear regression model: <span class="math display">\[ Y = \alpha_0 + \alpha_1X + \boldsymbol{\alpha}_2^\top \bf Z + \epsilon, \]</span> where <span class="math inline">\(Y\)</span> is the response variable, <span class="math inline">\(X\)</span> is the covariate of interest which is subject to right censoring, <span class="math inline">\(\bf Z\)</span> is a <span class="math inline">\(p\times 1\)</span> vector of additional covariates that are completely observed, <span class="math inline">\(\epsilon\)</span> is the random error term with mean 0 and finite variance, and the <span class="math inline">\(\alpha\)</span>’s are the corresponding regression coefficients. We assume <span class="math inline">\(epsilon\)</span> is independent of <span class="math inline">\(X\)</span>, <span class="math inline">\(\bf Z\)</span>, and <span class="math inline">\(C\)</span>, where <span class="math inline">\(C\)</span> is the right censoring that potentially censors <span class="math inline">\(X\)</span>. The primary scientific interest is in the parameter <span class="math inline">\(\alpha_1\)</span>, which captures the association between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span>. The <code>thlm</code> function provides</p>
<ol style="list-style-type: decimal">
<li>a test for <span class="math inline">\(H_o: \alpha_1 = 0\)</span> against its complement;</li>
<li>unbiased estimation of the regression coefficient of the censored covariate.</li>
</ol>
</div>
<div id="the-thlm-function" class="section level2">
<h2 class="hasAnchor">
<a href="#the-thlm-function" class="anchor"></a>The <code>thlm</code> function</h2>
<p>The <code>thlm</code> function presents the threshold regression approaches for linear regression models with a covariate that is subject to random censoring. The threshold regression methods allow for immediate testing of the significance of the effect of a censored covariate. The <strong><code>censCov</code></strong> package can be installed from CRAN with</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"censCov"</span>)</code></pre></div>
<p>or from GitHub with</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>devtools::<span class="kw">install_github</span>(<span class="st">"stc04003/censCov"</span>)</code></pre></div>
<p>The arguments of the <code>thlm</code> function are as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(censCov)
&gt;<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/args">args</a></span>(thlm)</code></pre></div>
<pre><code>function (formula, data, method = c("cc", "reverse", "deletion-threshold", 
    "complete-threshold", "all"), B = 0, subset, x.upplim = NULL, 
    t0 = NULL, control = thlm.control()) 
NULL</code></pre>
<ul>
<li>
<code>formula</code> is a formula expression in the form of <code>response ~ predictors</code>. The response variable is assumed to be fully observed. The <code>thlm</code> function can accommodate at most one censored covariate, which is entered in the formula as an <code>Surv</code> object; see <code><a href="https://www.rdocumentation.org/packages/survival/topics/Surv">survival::Surv</a></code> for more detail. If all the covariates are uncensored, the <code>thlm</code> function returns a <code>lm</code> object.</li>
<li>
<code>data</code> is an optional data frame, list or environment contains variables in the <code>formula</code> and the <code>subset</code> argument. If this is left unspecified, the variables are taken from the environment from which <code>thlm</code> is called.</li>
<li>
<code>method</code> is a character string specifying the threshold regression methods to be used. The following are permitted:
<ul>
<li>
<code>cc</code> for complete-cases regression</li>
<li>
<code>reverse</code> for complete-cases regression</li>
<li>
<code>deletion-threshold</code> for complete-cases regression</li>
<li>
<code>complete-threshold</code> for complete-cases regression</li>
<li>
<code>all</code> for complete-cases regression</li>
</ul>
</li>
<li>
<code>B</code> is a numeric value specifies the bootstrap size for estimating the standard error of the regression coefficient for the censored covariate when <code>method = "deletion-threshold"</code> or <code>method = "complete-threshold"</code>. When <code>B = 0</code> (default), only the beta estimate will be displayed.</li>
<li>
<code>subset</code> is an optional vector specifying a subset of observations to be used in the fitting process.</li>
<li>
<code>x.upplim</code> is an optional number value specifies the upper support of the censored covariate. When left unspecified, the maximum of the censored covariate will be used.</li>
<li>
<code>t0</code> is an optional numeric value specifies the threshold when <code>method = "deletion-threshold"</code> or <code>method = "complete-threshold"</code>. When left unspecified, an optimal threshold will be determined to optimize test power.</li>
<li>
<code>control</code> is a list of threshold parameters including:
<ul>
<li>
<code>t0.interval</code> controls the end points of the interval to be searched for the optimal threshold when <code>t0</code> is left unspecified</li>
<li>
<code>t0.plot</code> controls whether the objective function will be plotted. When t0.plot is true, both the raw <code>t0.plot</code> values and the smoothed estimates (using local polynomial regression fitting) are plotted.</li>
</ul>
</li>
</ul>
</div>
<div id="illustrative-simulated-data" class="section level2">
<h2 class="hasAnchor">
<a href="#illustrative-simulated-data" class="anchor"></a>Illustrative (simulated) data</h2>
<p>We will illustrate the usage of <code>thlm</code> with a simulated data that is generated as below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>simDat &lt;-<span class="st"> </span>function(n) {
+<span class="st">   </span>X &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Exponential">rexp</a></span>(n, <span class="dv">3</span>)
+<span class="st">   </span>Z &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Uniform">runif</a></span>(n, <span class="dv">1</span>, <span class="dv">6</span>)
+<span class="st">   </span>Y &lt;-<span class="st"> </span><span class="fl">0.5</span> +<span class="st"> </span><span class="fl">0.5</span> *<span class="st"> </span>X -<span class="st"> </span><span class="fl">0.5</span> *<span class="st"> </span>Z +<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(n, <span class="dv">0</span>, .<span class="dv">75</span>)
+<span class="st">   </span>cstime &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Exponential">rexp</a></span>(n, .<span class="dv">75</span>)
+<span class="st">   </span>delta &lt;-<span class="st"> </span>(X &lt;=<span class="st"> </span>cstime) *<span class="st"> </span><span class="dv">1</span>
+<span class="st">   </span>X &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">pmin</a></span>(X, cstime)
+<span class="st">   </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">Y =</span> Y, <span class="dt">X =</span> X, <span class="dt">Z =</span> Z, <span class="dt">delta =</span> delta)
+<span class="st"> </span>}
&gt;<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">1</span>)
&gt;<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(dat &lt;-<span class="st"> </span><span class="kw">simDat</span>(<span class="dv">200</span>), <span class="dv">10</span>)</code></pre></div>
<pre><code>            Y          X        Z delta
1  -1.4004305 0.25172728 5.432294     1
2  -0.6842887 0.39388093 3.359654     1
3  -0.5541144 0.04856891 1.545505     1
4   0.1832982 0.04659842 2.666390     1
5  -2.5467871 0.14535621 5.187083     1
6  -0.6450906 0.49887130 2.384249     0
7  -2.0134650 0.40985402 3.935176     1
8  -2.5030175 0.17989428 5.183661     1
9   0.6904316 0.31885583 1.355770     1
10 -1.4071626 0.04901533 4.513894     1</code></pre>
<p>The columns in the simulated data set, <code>dat</code>, are</p>
<ul>
<li>
<code>Y</code> is the response variable</li>
<li>
<code>X</code> is the covariate of interest when <code>delta = 1</code> or the right censored value when <code>delta = 0</code>
</li>
<li>
<code>Z</code> is an additional covariate that is completely observed</li>
<li>
<code>delta</code> is the censoring indicator for <code>X</code>
</li>
</ul>
<p>The average censoring percentage is about 20%.</p>
</div>
<div id="methods" class="section level2">
<h2 class="hasAnchor">
<a href="#methods" class="anchor"></a>Methods</h2>
<p>The following methods for censored covariates are implemented in <code>thlm</code>.</p>
<div id="complete-cases" class="section level3">
<h3 class="hasAnchor">
<a href="#complete-cases" class="anchor"></a>Complete cases</h3>
<p>When <code>method = "cc"</code>, <code>thlm</code> removes rows with <code>delta = 0</code> and fits the linear model via <code>lm</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw"><a href="../reference/thlm.html">thlm</a></span>(Y ~<span class="st"> </span><span class="kw">Surv</span>(X, delta) +<span class="st"> </span>Z, <span class="dt">data =</span> dat, <span class="dt">method =</span> <span class="st">"cc"</span>)</code></pre></div>
<pre><code>
 Call: thlm(formula = Y ~ Surv(X, delta) + Z, data = dat, method = "cc")

 Hypothesis test of association
H0: a1 = 0, p-value = 0.1028 </code></pre>
<p>or</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw"><a href="../reference/thlm.html">thlm</a></span>(Y ~<span class="st"> </span>X +<span class="st"> </span>Z, <span class="dt">data =</span> dat, <span class="dt">subset =</span> delta ==<span class="st"> </span><span class="dv">1</span>)</code></pre></div>
<pre><code>
 Call: thlm(formula = Y ~ X + Z, data = dat, subset = delta == 1)

 Hypothesis test of association
 H0: a1 = 0, p-value = 0.1047 </code></pre>
<p>The two <span class="math inline">\(p\)</span>-values differs a bit because the <code>thlm</code> returns the Wald <span class="math inline">\(p\)</span>-value.</p>
</div>
<div id="reverse-survival-regression" class="section level3">
<h3 class="hasAnchor">
<a href="#reverse-survival-regression" class="anchor"></a>Reverse survival regression</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(<span class="kw"><a href="../reference/thlm.html">thlm</a></span>(Y ~<span class="st"> </span><span class="kw">Surv</span>(X, delta) +<span class="st"> </span>Z, <span class="dt">data =</span> dat, <span class="dt">method =</span> <span class="st">"rev"</span>))</code></pre></div>
<pre><code>Call:
thlm(formula = Y ~ Surv(X, delta) + Z, data = dat, method = "rev")

 Reverse survival regression

 Coefficients:
  Estimate   StdErr z.value p.value  
Y -0.18333  0.10056  -1.823  0.0683 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div id="deletion-threshold-regression" class="section level3">
<h3 class="hasAnchor">
<a href="#deletion-threshold-regression" class="anchor"></a>Deletion threshold regression</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(<span class="kw"><a href="../reference/thlm.html">thlm</a></span>(Y ~<span class="st"> </span><span class="kw">Surv</span>(X, delta) +<span class="st"> </span>Z, <span class="dt">data =</span> dat, <span class="dt">method =</span> <span class="st">"del"</span>, <span class="dt">B =</span> <span class="dv">100</span>))</code></pre></div>
<p><img src="censCov-examples_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<pre><code>Call:
thlm(formula = Y ~ Surv(X, delta) + Z, data = dat, method = "del", 
    B = 100)

 Deletion threshold regression
 Optimal threshold is 0.394 

 Coefficients:
      Estimate    StdErr  z.value   p.value    
a1:X  0.642742  0.235796   2.7258  0.006414 ** 
a2:Z -0.527387  0.039061 -13.5018 &lt; 2.2e-16 ***
b1:X  0.307045  0.117716   2.6084  0.009098 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Under the assumption that X is independent of Z given X*. See ?thlm for more detail.</code></pre>
</div>
<div id="complete-threshold-regression" class="section level3">
<h3 class="hasAnchor">
<a href="#complete-threshold-regression" class="anchor"></a>Complete threshold regression</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(<span class="kw"><a href="../reference/thlm.html">thlm</a></span>(Y ~<span class="st"> </span><span class="kw">Surv</span>(X, delta) +<span class="st"> </span>Z, <span class="dt">data =</span> dat, <span class="dt">method =</span> <span class="st">"com"</span>, <span class="dt">B =</span> <span class="dv">100</span>))</code></pre></div>
<p><img src="censCov-examples_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<pre><code>Call:
thlm(formula = Y ~ Surv(X, delta) + Z, data = dat, method = "com", 
    B = 100)

 Complete threshold regression
 Optimal threshold is 0.481 

 Coefficients:
      Estimate    StdErr  z.value p.value    
a1:X  0.368099  0.304016   1.2108  0.2260    
a2:Z -0.521533  0.036569 -14.2617  &lt;2e-16 ***
b1:X  0.185574  0.138638   1.3386  0.1807    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Under the assumption that X is independent of Z given X*. See ?thlm for more detail.</code></pre>
</div>
<div id="all" class="section level3">
<h3 class="hasAnchor">
<a href="#all" class="anchor"></a>All</h3>
<p>The <code>thlm</code> function allows <code>method = "all"</code> that runs the complete cases analysis, reverse survival regression, deletion threshold regression, and complete threshold regression at once.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(<span class="kw"><a href="../reference/thlm.html">thlm</a></span>(Y ~<span class="st"> </span><span class="kw">Surv</span>(X, delta) +<span class="st"> </span>Z, <span class="dt">data =</span> dat, <span class="dt">method =</span> <span class="st">"all"</span>, <span class="dt">B =</span> <span class="dv">100</span>, 
+<span class="st">              </span><span class="dt">control =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">t0.plot =</span> <span class="ot">FALSE</span>)))</code></pre></div>
<pre><code>Call:
thlm(formula = Y ~ Surv(X, delta) + Z, data = dat, method = "all", 
    B = 100, control = list(t0.plot = FALSE))

Complete-case regression

 Coefficients:
   Estimate    StdErr  z.value p.value    
X  0.345912  0.212040   1.6314  0.1028    
Z -0.526268  0.040216 -13.0861  &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Reverse survival regression

 Coefficients:
  Estimate   StdErr z.value p.value  
Y -0.18333  0.10056  -1.823  0.0683 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Deletion threshold regression
 Optimal threshold is 0.394
 Coefficients:
      Estimate    StdErr  z.value   p.value    
a1:X  0.642742  0.264088   2.4338  0.014941 *  
a2:Z -0.527387  0.039061 -13.5018 &lt; 2.2e-16 ***
b1:X  0.307045  0.117716   2.6084  0.009098 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Complete threshold regression
 Optimal threshold is 0.481
 Coefficients:
      Estimate    StdErr  z.value p.value    
a1:X  0.368099  0.308850   1.1918  0.2333    
a2:Z -0.521533  0.036569 -14.2617  &lt;2e-16 ***
b1:X  0.185574  0.138638   1.3386  0.1807    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Under the assumption that X is independent of Z given X*. See ?thlm for more detail.</code></pre>
</div>
</div>
<div id="faq" class="section level2">
<h2 class="hasAnchor">
<a href="#faq" class="anchor"></a>FAQ</h2>
<p><strong>Can <code>thlm</code> fit model with one censored covariate (<span class="math inline">\(X\)</span>) without any fully observed covaraite (<span class="math inline">\(Z\)</span>)?</strong></p>
<p>Yes. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(<span class="kw"><a href="../reference/thlm.html">thlm</a></span>(Y ~<span class="st"> </span><span class="kw">Surv</span>(X, delta), <span class="dt">data =</span> dat, <span class="dt">method =</span> <span class="st">"all"</span>, <span class="dt">B =</span> <span class="dv">100</span>, 
+<span class="st">              </span><span class="dt">control =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">t0.plot =</span> <span class="ot">FALSE</span>)))</code></pre></div>
<pre><code>Call:
thlm(formula = Y ~ Surv(X, delta), data = dat, method = "all", 
    B = 100, control = list(t0.plot = FALSE))

Complete-case regression

 Coefficients:
  Estimate  StdErr z.value p.value
X  0.10360 0.30109  0.3441  0.7308

Reverse survival regression

 Coefficients:
   Estimate    StdErr z.value p.value
Y -0.059851  0.076203 -0.7854  0.4322

Deletion threshold regression
 Optimal threshold is 0.394
 Coefficients:
     Estimate  StdErr z.value p.value
a1:X  0.49723 0.34765  1.4303  0.1526
b1:X  0.23753 0.16906  1.4051  0.1600

Complete threshold regression
 Optimal threshold is 0.481
 Coefficients:
     Estimate   StdErr z.value p.value
a1:X 0.082171 0.363501  0.2261  0.8212
b1:X 0.041426 0.196624  0.2107  0.8331

Under the assumption that X is independent of Z given X*. See ?thlm for more detail.</code></pre>
<p><strong>Can <code>thlm</code> fit model with one censored covariate (<span class="math inline">\(X\)</span>) and multiple fully observed covaraites (<span class="math inline">\(Z\)</span>)?</strong></p>
<p>Yes. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>dat$Z2 &lt;-<span class="st"> </span>dat$Z^<span class="dv">2</span>
&gt;<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(<span class="kw"><a href="../reference/thlm.html">thlm</a></span>(Y ~<span class="st"> </span><span class="kw">Surv</span>(X, delta) +<span class="st"> </span>Z +<span class="st"> </span>Z2, <span class="dt">data =</span> dat, <span class="dt">method =</span> <span class="st">"all"</span>, <span class="dt">B =</span> <span class="dv">100</span>, 
+<span class="st">              </span><span class="dt">control =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">t0.plot =</span> <span class="ot">FALSE</span>)))</code></pre></div>
<pre><code>Call:
thlm(formula = Y ~ Surv(X, delta) + Z + Z2, data = dat, method = "all", 
    B = 100, control = list(t0.plot = FALSE))

Complete-case regression

 Coefficients:
    Estimate    StdErr z.value  p.value   
X   0.350485  0.212926  1.6460 0.099754 . 
Z  -0.608191  0.216904 -2.8040 0.005048 **
Z2  0.011590  0.030151  0.3844 0.700687   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Reverse survival regression

 Coefficients:
  Estimate   StdErr z.value p.value  
Y -0.18087  0.10079 -1.7946 0.07272 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Deletion threshold regression
 Optimal threshold is 0.394
 Coefficients:
       Estimate    StdErr z.value  p.value   
a1:X   0.654823  0.253949  2.5786 0.009921 **
a2:Z  -0.623451  0.211023 -2.9544 0.003132 **
a3:Z2  0.013604  0.029366  0.4633 0.643169   
b1:X   0.312817  0.118646  2.6366 0.008375 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Complete threshold regression
 Optimal threshold is 0.481
 Coefficients:
        Estimate     StdErr z.value  p.value   
a1:X   0.3745097  0.2656319  1.4099 0.158575   
a2:Z  -0.5685414  0.1997397 -2.8464 0.004422 **
a3:Z2  0.0066448  0.0277542  0.2394 0.810784   
b1:X   0.1888058  0.1396247  1.3522 0.176299   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Under the assumption that X is independent of Z given X*. See ?thlm for more detail.</code></pre>
<p><strong>Does the censored covariate (<span class="math inline">\(X\)</span>) need to be specified first in the <code>formula</code>?</strong></p>
<p>Not nesscary. For exmaple:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>dat$Z2 &lt;-<span class="st"> </span>dat$Z^<span class="dv">2</span>
&gt;<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(<span class="kw"><a href="../reference/thlm.html">thlm</a></span>(Y ~<span class="st"> </span>Z +<span class="st"> </span><span class="kw">Surv</span>(X, delta) +<span class="st"> </span>Z2, <span class="dt">data =</span> dat, <span class="dt">method =</span> <span class="st">"all"</span>, <span class="dt">B =</span> <span class="dv">100</span>, 
+<span class="st">              </span><span class="dt">control =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">t0.plot =</span> <span class="ot">FALSE</span>)))</code></pre></div>
<pre><code>Call:
thlm(formula = Y ~ Z + Surv(X, delta) + Z2, data = dat, method = "all", 
    B = 100, control = list(t0.plot = FALSE))

Complete-case regression

 Coefficients:
    Estimate    StdErr z.value  p.value   
X   0.350485  0.212926  1.6460 0.099754 . 
Z  -0.608191  0.216904 -2.8040 0.005048 **
Z2  0.011590  0.030151  0.3844 0.700687   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Reverse survival regression

 Coefficients:
  Estimate   StdErr z.value p.value  
Y -0.18087  0.10079 -1.7946 0.07272 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Deletion threshold regression
 Optimal threshold is 0.394
 Coefficients:
       Estimate    StdErr z.value  p.value   
a1:X   0.654823  0.274355  2.3868 0.016997 * 
a2:Z  -0.623451  0.211023 -2.9544 0.003132 **
a3:Z2  0.013604  0.029366  0.4633 0.643169   
b1:X   0.312817  0.118646  2.6366 0.008375 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Complete threshold regression
 Optimal threshold is 0.481
 Coefficients:
        Estimate     StdErr z.value  p.value   
a1:X   0.3745097  0.2989135  1.2529 0.210241   
a2:Z  -0.5685414  0.1997397 -2.8464 0.004422 **
a3:Z2  0.0066448  0.0277542  0.2394 0.810784   
b1:X   0.1888058  0.1396247  1.3522 0.176299   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Under the assumption that X is independent of Z given X*. See ?thlm for more detail.</code></pre>
<p><strong>Can <code>thlm</code> fit model with more than one censored covariate (<span class="math inline">\(X\)</span>)?</strong></p>
<p>No.</p>
</div>
<div id="reference" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#reference" class="anchor"></a>Reference</h2>
<div id="refs" class="references">
<div id="ref-qian2018threshold">
<p>Qian, Jing, Sy Han Chiou, Jacqueline E Maye, Folefac Atem, Keith A Johnson, and Rebecca A Betensky. 2018. “Threshold Regression to Accommodate a Censored Covariate.” <em>Biometrics</em> 74 (4). Wiley Online Library: 1261–70.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#notations">Notations</a></li>
      <li><a href="#the-thlm-function">The <code>thlm</code> function</a></li>
      <li><a href="#illustrative-simulated-data">Illustrative (simulated) data</a></li>
      <li><a href="#methods">Methods</a></li>
      <li><a href="#faq">FAQ</a></li>
      <li><a href="#reference">Reference</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Jing Qian.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
